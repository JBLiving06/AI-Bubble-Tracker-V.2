<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Bubble Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: "Inter", system-ui, sans-serif;
      background: linear-gradient(135deg, #0a0f1a 0%, #111827 50%, #0f172a 100%);
      min-height: 100vh;
    }
    .gauge-card {
      backdrop-filter: blur(12px);
      transition: all 0.3s ease;
    }
    .gauge-card:hover {
      transform: translateY(-2px);
    }
    .gauge-card.selected {
      transform: scale(1.02);
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    .animate-slide-up { animation: slideUp 0.5s ease-out forwards; }
    .font-mono { font-family: "JetBrains Mono", monospace; }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #1e293b; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
  </style>
</head>
<body class="bg-slate-950 text-slate-100 antialiased">
  <div id="root"></div>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;

    // Gauge configurations
    const GAUGE_CONFIGS = [
      { key: "capex-revenue", name: "CapEx-to-Revenue", description: "Hyperscaler AI infrastructure spend vs revenue", category: "Financial Fundamentals", unit: "ratio", automated: true, inverted: false, safeThreshold: 0.30, warningThreshold: 0.50, format: v => v.toFixed(2), interpretation: { safe: "≤30% - Healthy reinvestment", warning: "30-50% - Elevated spending", danger: ">50% - Potentially unsustainable" } },
      { key: "gdp-dependence", name: "GDP Dependence", description: "GDP growth reliance on datacenter buildout", category: "Economic Impact", unit: "%", automated: false, inverted: false, safeThreshold: 0.5, warningThreshold: 1.5, format: v => `${v.toFixed(1)}%`, interpretation: { safe: "≤0.5% - Minimal dependence", warning: "0.5-1.5% - Moderate risk", danger: ">1.5% - Dangerous reliance" } },
      { key: "market-concentration", name: "Market Concentration", description: "AI megacap dominance in market gains", category: "Market Structure", unit: "index", automated: true, inverted: false, safeThreshold: 40, warningThreshold: 70, format: v => v.toFixed(0), interpretation: { safe: "≤40 - Broad participation", warning: "40-70 - Increasing concentration", danger: ">70 - Extreme narrow leadership" } },
      { key: "application-maturity", name: "Application Maturity", description: "Production AI apps beyond pilots", category: "Product Adoption", unit: "score", automated: false, inverted: true, safeThreshold: 60, warningThreshold: 35, format: v => v.toFixed(0), interpretation: { safe: "≥60 - Strong production adoption", warning: "35-60 - Pilots dominating", danger: "<35 - Little production value" } },
      { key: "infrastructure-strain", name: "Infrastructure Strain", description: "Grid, water, cooling stress from AI", category: "Physical Infrastructure", unit: "index", automated: false, inverted: false, safeThreshold: 40, warningThreshold: 70, format: v => v.toFixed(0), interpretation: { safe: "≤40 - Manageable capacity", warning: "40-70 - Approaching limits", danger: ">70 - Critical strain" } },
      { key: "valuation-metrics", name: "Valuation Heat", description: "P/E ratios vs historical norms", category: "Market Valuation", unit: "P/E", automated: true, inverted: false, safeThreshold: 22, warningThreshold: 30, format: v => v.toFixed(1), interpretation: { safe: "≤22 - Historical average", warning: "22-30 - Extended valuation", danger: ">30 - Bubble-level multiples" } },
      { key: "debt-financing", name: "Debt & Leverage", description: "Debt reliance for AI buildout", category: "Financial Leverage", unit: "ratio", automated: true, inverted: false, safeThreshold: 0.5, warningThreshold: 1.0, format: v => v.toFixed(2), interpretation: { safe: "≤0.5 - Conservative", warning: "0.5-1.0 - Elevated", danger: ">1.0 - High leverage risk" } },
      { key: "regulatory-risk", name: "Regulatory Risk", description: "Policy and antitrust headwinds", category: "Policy & Regulation", unit: "score", automated: false, inverted: false, safeThreshold: 40, warningThreshold: 70, format: v => v.toFixed(0), interpretation: { safe: "≤40 - Supportive environment", warning: "40-70 - Uncertainty increasing", danger: ">70 - Restrictive actions imminent" } },
      { key: "geographic-concentration", name: "Geographic Concentration", description: "Infrastructure clustering in few regions", category: "Geographic Risk", unit: "index", automated: false, inverted: false, safeThreshold: 50, warningThreshold: 75, format: v => v.toFixed(0), interpretation: { safe: "≤50 - Well-distributed", warning: "50-75 - Moderate clustering", danger: ">75 - Dangerous concentration" } },
      { key: "sentiment-speculation", name: "Sentiment & Speculation", description: "IPO activity, retail flows, hype levels", category: "Market Sentiment", unit: "index", automated: true, inverted: false, safeThreshold: 50, warningThreshold: 75, format: v => v.toFixed(0), interpretation: { safe: "≤50 - Rational enthusiasm", warning: "50-75 - Elevated speculation", danger: ">75 - Excessive froth" } },
    ];

    const RISK_COLORS = {
      safe: { primary: "#10b981", glow: "rgba(16, 185, 129, 0.3)" },
      warning: { primary: "#f59e0b", glow: "rgba(245, 158, 11, 0.3)" },
      danger: { primary: "#ef4444", glow: "rgba(239, 68, 68, 0.3)" },
    };

    const OVERALL_RISK_CONFIG = {
      NORMAL: { color: "#10b981", bg: "rgba(16, 185, 129, 0.1)", label: "Normal Market", action: "Continue standard monitoring" },
      CAUTION: { color: "#f59e0b", bg: "rgba(245, 158, 11, 0.1)", label: "Caution", action: "Increase vigilance, review positions" },
      OVERHEATING: { color: "#f97316", bg: "rgba(249, 115, 22, 0.1)", label: "Overheating", action: "Reduce exposure, tighten risk management" },
      BUBBLE: { color: "#ef4444", bg: "rgba(239, 68, 68, 0.1)", label: "Bubble Territory", action: "Defensive positioning recommended" },
    };

    function calculateRiskLevel(value, config) {
      const { safeThreshold, warningThreshold, inverted } = config;
      if (inverted) {
        if (value >= safeThreshold) return "safe";
        if (value >= warningThreshold) return "warning";
        return "danger";
      } else {
        if (value <= safeThreshold) return "safe";
        if (value <= warningThreshold) return "warning";
        return "danger";
      }
    }

    function calculateOverallRisk(counts) {
      if (counts.danger >= 4) return "BUBBLE";
      if (counts.danger >= 2) return "OVERHEATING";
      if (counts.danger >= 1 || counts.warning >= 5) return "CAUTION";
      return "NORMAL";
    }

    // Demo readings matching EV's current assessment
    const DEMO_READINGS = {
      "capex-revenue": { value: 0.42, trend: "rising" },
      "gdp-dependence": { value: 0.8, trend: "stable" },
      "market-concentration": { value: 71, trend: "rising" },
      "application-maturity": { value: 48, trend: "improving" },
      "infrastructure-strain": { value: 52, trend: "rising" },
      "valuation-metrics": { value: 34.2, trend: "worsening" },
      "debt-financing": { value: 0.68, trend: "stable" },
      "regulatory-risk": { value: 45, trend: "rising" },
      "geographic-concentration": { value: 62, trend: "stable" },
      "sentiment-speculation": { value: 61, trend: "rising" },
    };

    // GaugeMeter Component
    function GaugeMeter({ config, reading, isSelected, onSelect }) {
      const [animatedAngle, setAnimatedAngle] = useState(0);
      const value = reading?.value ?? 0;
      const riskLevel = reading ? calculateRiskLevel(value, config) : "safe";
      const trend = reading?.trend ?? "stable";

      const getTargetAngle = useCallback(() => {
        const max = config.inverted ? config.safeThreshold * 1.5 : config.warningThreshold * 1.5;
        const normalized = Math.min(Math.max(value, 0), max);
        return (normalized / max) * 180;
      }, [value, config]);

      useEffect(() => {
        const timer = setTimeout(() => setAnimatedAngle(getTargetAngle()), 100);
        return () => clearTimeout(timer);
      }, [getTargetAngle]);

      const trendIcons = { rising: "↗", falling: "↘", stable: "→", improving: "↗", worsening: "↘" };
      const colors = RISK_COLORS[riskLevel];

      return (
        <div
          onClick={() => onSelect(config.key)}
          className={`gauge-card relative p-5 rounded-xl cursor-pointer bg-slate-800/60 hover:bg-slate-800/80 ${isSelected ? 'selected ring-2 ring-cyan-500/50 bg-slate-800/90' : ''}`}
          style={{ boxShadow: isSelected ? `0 0 30px ${colors.glow}` : '0 4px 20px rgba(0, 0, 0, 0.3)' }}
        >
          <div className="flex items-start justify-between mb-4">
            <div>
              <div className="flex items-center gap-2 mb-1">
                <span className={`w-2 h-2 rounded-full ${config.automated ? 'bg-cyan-400' : 'bg-amber-400'}`} />
                <span className="text-[10px] uppercase tracking-wider text-slate-500">{config.category}</span>
              </div>
              <h3 className="text-sm font-semibold text-slate-200">{config.name}</h3>
            </div>
            <div className={`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider ${riskLevel === 'safe' ? 'bg-emerald-500/20 text-emerald-400' : riskLevel === 'warning' ? 'bg-amber-500/20 text-amber-400' : 'bg-red-500/20 text-red-400'}`}>
              {riskLevel}
            </div>
          </div>

          <div className="relative flex justify-center mb-4">
            <svg viewBox="0 0 200 110" className="w-full max-w-[180px]">
              <defs>
                <linearGradient id={`grad-safe-${config.key}`} x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stopColor="#10b981" stopOpacity="0.8" />
                  <stop offset="100%" stopColor="#10b981" stopOpacity="0.4" />
                </linearGradient>
                <linearGradient id={`grad-warning-${config.key}`} x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stopColor="#f59e0b" stopOpacity="0.8" />
                  <stop offset="100%" stopColor="#f59e0b" stopOpacity="0.4" />
                </linearGradient>
                <linearGradient id={`grad-danger-${config.key}`} x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stopColor="#ef4444" stopOpacity="0.4" />
                  <stop offset="100%" stopColor="#ef4444" stopOpacity="0.8" />
                </linearGradient>
                <filter id={`glow-${config.key}`}>
                  <feGaussianBlur stdDeviation="2" result="coloredBlur" />
                  <feMerge><feMergeNode in="coloredBlur" /><feMergeNode in="SourceGraphic" /></feMerge>
                </filter>
              </defs>
              <path d="M 20 100 A 80 80 0 0 1 180 100" fill="none" stroke="#1e293b" strokeWidth="16" strokeLinecap="round" />
              <path d="M 20 100 A 80 80 0 0 1 80 30" fill="none" stroke={`url(#grad-safe-${config.key})`} strokeWidth="14" strokeLinecap="round" />
              <path d="M 80 30 A 80 80 0 0 1 140 40" fill="none" stroke={`url(#grad-warning-${config.key})`} strokeWidth="14" strokeLinecap="round" />
              <path d="M 140 40 A 80 80 0 0 1 180 100" fill="none" stroke={`url(#grad-danger-${config.key})`} strokeWidth="14" strokeLinecap="round" />
              <g style={{ transformOrigin: '100px 100px', transform: `rotate(${animatedAngle - 90}deg)`, transition: 'transform 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)' }}>
                <line x1="100" y1="100" x2="100" y2="35" stroke={colors.primary} strokeWidth="3" strokeLinecap="round" filter={`url(#glow-${config.key})`} />
                <circle cx="100" cy="100" r="8" fill={colors.primary} filter={`url(#glow-${config.key})`} />
                <circle cx="100" cy="100" r="4" fill="#0f172a" />
              </g>
            </svg>
          </div>

          <div className="text-center mb-3">
            <span className="text-2xl font-mono font-bold" style={{ color: colors.primary }}>
              {reading ? config.format(reading.value) : '—'}
            </span>
            <span className="text-slate-500 text-sm ml-2">{trendIcons[trend] || '→'}</span>
          </div>

          <div className="flex items-center justify-between text-[10px] text-slate-500">
            <span>{config.automated ? 'Auto' : 'Manual'}</span>
            <span>Dec 6, 2025</span>
          </div>
        </div>
      );
    }

    // RiskAssessment Component
    function RiskAssessment({ counts }) {
      const overallRisk = calculateOverallRisk(counts);
      const config = OVERALL_RISK_CONFIG[overallRisk];

      return (
        <div className="rounded-2xl p-6 mb-8 animate-fade-in" style={{ background: `linear-gradient(135deg, ${config.bg}, rgba(15, 23, 42, 0.8))`, border: `1px solid ${config.color}40` }}>
          <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
            <div className="flex items-center gap-4">
              <div className="w-20 h-20 rounded-2xl flex items-center justify-center" style={{ background: `linear-gradient(135deg, ${config.color}30, ${config.color}10)`, boxShadow: `0 0 40px ${config.color}20` }}>
                <span className="text-4xl font-black" style={{ color: config.color }}>{counts.danger}</span>
              </div>
              <div>
                <div className="text-slate-500 text-xs uppercase tracking-wider mb-1">Current Assessment</div>
                <div className="text-2xl font-bold tracking-tight" style={{ color: config.color }}>{config.label}</div>
                <div className="text-slate-400 text-sm mt-1">{config.action}</div>
              </div>
            </div>
            <div className="flex gap-6">
              <div className="text-center">
                <div className="text-3xl font-bold text-emerald-400">{counts.safe}</div>
                <div className="text-[10px] uppercase tracking-wider text-slate-500">Safe</div>
              </div>
              <div className="text-center">
                <div className="text-3xl font-bold text-amber-400">{counts.warning}</div>
                <div className="text-[10px] uppercase tracking-wider text-slate-500">Warning</div>
              </div>
              <div className="text-center">
                <div className="text-3xl font-bold text-red-400">{counts.danger}</div>
                <div className="text-[10px] uppercase tracking-wider text-slate-500">Danger</div>
              </div>
            </div>
          </div>
          <div className="mt-6 h-2 rounded-full overflow-hidden bg-slate-700/50 flex">
            <div className="h-full bg-emerald-500 transition-all duration-500" style={{ width: `${(counts.safe / 10) * 100}%` }} />
            <div className="h-full bg-amber-500 transition-all duration-500" style={{ width: `${(counts.warning / 10) * 100}%` }} />
            <div className="h-full bg-red-500 transition-all duration-500" style={{ width: `${(counts.danger / 10) * 100}%` }} />
          </div>
        </div>
      );
    }

    // GaugeDetail Component
    function GaugeDetail({ config, reading, onClose }) {
      const riskLevel = reading ? calculateRiskLevel(reading.value, config) : "safe";
      
      return (
        <div className="bg-slate-800/60 rounded-xl p-6 backdrop-blur-lg animate-slide-up">
          <div className="flex items-start justify-between mb-4">
            <div>
              <h2 className="text-xl font-bold text-slate-100">{config.name}</h2>
              <p className="text-slate-400 text-sm mt-1">{config.description}</p>
            </div>
            <div className="flex items-center gap-2">
              <span className={`px-3 py-1 rounded-lg text-xs font-bold uppercase ${config.automated ? 'bg-cyan-500/20 text-cyan-400' : 'bg-amber-500/20 text-amber-400'}`}>
                {config.automated ? 'Automated' : 'Manual'}
              </span>
              <button onClick={onClose} className="p-1 rounded hover:bg-slate-700 transition-colors text-slate-400">✕</button>
            </div>
          </div>

          <div className="grid grid-cols-3 gap-4 mb-6">
            <div className="bg-slate-900/50 rounded-lg p-4">
              <div className="text-slate-500 text-xs uppercase tracking-wider mb-1">Current</div>
              <div className="text-2xl font-mono font-bold" style={{ color: RISK_COLORS[riskLevel].primary }}>
                {reading ? config.format(reading.value) : '—'}
              </div>
            </div>
            <div className="bg-slate-900/50 rounded-lg p-4">
              <div className="text-slate-500 text-xs uppercase tracking-wider mb-1">{config.inverted ? 'Safe Above' : 'Safe Below'}</div>
              <div className="text-2xl font-mono font-bold text-emerald-400">{config.format(config.safeThreshold)}</div>
            </div>
            <div className="bg-slate-900/50 rounded-lg p-4">
              <div className="text-slate-500 text-xs uppercase tracking-wider mb-1">{config.inverted ? 'Danger Below' : 'Danger Above'}</div>
              <div className="text-2xl font-mono font-bold text-red-400">{config.format(config.warningThreshold)}</div>
            </div>
          </div>

          <div className="mb-6">
            <div className="text-slate-500 text-xs uppercase tracking-wider mb-2">Interpretation Guide</div>
            <div className="space-y-2 text-sm">
              <div className="flex items-start gap-2">
                <span className="w-2 h-2 rounded-full bg-emerald-500 mt-1.5" />
                <span className="text-slate-400">{config.interpretation.safe}</span>
              </div>
              <div className="flex items-start gap-2">
                <span className="w-2 h-2 rounded-full bg-amber-500 mt-1.5" />
                <span className="text-slate-400">{config.interpretation.warning}</span>
              </div>
              <div className="flex items-start gap-2">
                <span className="w-2 h-2 rounded-full bg-red-500 mt-1.5" />
                <span className="text-slate-400">{config.interpretation.danger}</span>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Main App
    function App() {
      const [readings, setReadings] = useState(DEMO_READINGS);
      const [selectedGaugeKey, setSelectedGaugeKey] = useState(null);
      const [isRefreshing, setIsRefreshing] = useState(false);

      const riskCounts = useMemo(() => {
        return GAUGE_CONFIGS.reduce((acc, config) => {
          const reading = readings[config.key];
          const level = reading ? calculateRiskLevel(reading.value, config) : "safe";
          acc[level]++;
          return acc;
        }, { safe: 0, warning: 0, danger: 0 });
      }, [readings]);

      const handleRefresh = async () => {
        setIsRefreshing(true);
        await new Promise(r => setTimeout(r, 1500));
        // Simulate slight variance on refresh
        const newReadings = {};
        Object.entries(DEMO_READINGS).forEach(([key, reading]) => {
          const variance = (Math.random() - 0.5) * reading.value * 0.1;
          newReadings[key] = { ...reading, value: reading.value + variance };
        });
        setReadings(newReadings);
        setIsRefreshing(false);
      };

      const selectedConfig = GAUGE_CONFIGS.find(c => c.key === selectedGaugeKey);
      const selectedReading = selectedGaugeKey ? readings[selectedGaugeKey] : null;

      return (
        <div className="min-h-screen p-6 md:p-8">
          <div className="max-w-7xl mx-auto">
            <div className="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-8">
              <div>
                <div className="flex items-center gap-3 mb-2">
                  <div className="w-3 h-3 rounded-full bg-cyan-400 animate-pulse" />
                  <span className="text-cyan-400 text-xs uppercase tracking-widest">Live Monitoring</span>
                </div>
                <h1 className="text-3xl md:text-4xl font-black text-slate-100 tracking-tight">AI Bubble Tracker</h1>
                <p className="text-slate-500 mt-2">10 gauges · 5 automated · 5 manual assessment</p>
              </div>
              <button
                onClick={handleRefresh}
                disabled={isRefreshing}
                className="px-4 py-2 rounded-lg font-medium text-sm bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30 flex items-center gap-2 disabled:opacity-50"
              >
                <svg className={`w-4 h-4 ${isRefreshing ? 'animate-spin' : ''}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                {isRefreshing ? 'Refreshing...' : 'Refresh Data'}
              </button>
            </div>

            <RiskAssessment counts={riskCounts} />

            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <div className="lg:col-span-2">
                <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                  {GAUGE_CONFIGS.map(config => (
                    <GaugeMeter
                      key={config.key}
                      config={config}
                      reading={readings[config.key]}
                      isSelected={selectedGaugeKey === config.key}
                      onSelect={setSelectedGaugeKey}
                    />
                  ))}
                </div>
              </div>

              <div className="lg:col-span-1">
                {selectedConfig ? (
                  <GaugeDetail
                    config={selectedConfig}
                    reading={selectedReading}
                    onClose={() => setSelectedGaugeKey(null)}
                  />
                ) : (
                  <div className="bg-slate-800/40 rounded-xl p-6 border border-dashed border-slate-700 h-full min-h-[300px] flex items-center justify-center">
                    <div className="text-center text-slate-500">
                      <div className="text-4xl mb-3">◎</div>
                      <div className="text-sm">Select a gauge to view details</div>
                    </div>
                  </div>
                )}
              </div>
            </div>

            <div className="mt-8 flex flex-wrap items-center justify-center gap-6 text-xs text-slate-500">
              <div className="flex items-center gap-2">
                <span className="w-2 h-2 rounded-full bg-cyan-400" />
                <span>Automated gauge</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="w-2 h-2 rounded-full bg-amber-400" />
                <span>Manual assessment</span>
              </div>
              <div className="flex items-center gap-4 ml-4 pl-4 border-l border-slate-700">
                <span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-emerald-500" /> Safe</span>
                <span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-amber-500" /> Warning</span>
                <span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-red-500" /> Danger</span>
              </div>
            </div>

            <div className="mt-8 text-center text-slate-600 text-xs">
              Rule of thumb: 1 red = caution · 2-3 red = overheating · 4+ red = bubble territory
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
